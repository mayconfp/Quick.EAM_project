
{%include 'usuarios/partials/nav.html'%}



{% block content %}
<h2>Editar Perfil</h2>

<!-- Exibir Nome de Usuário e E-mail atuais -->
<div class="user-info">
    <p><strong>Nome de Usuário:</strong> <span id="username-display">{{ request.user.username }}</span></p>
    <p><strong>E-mail:</strong> <span id="email-display">{{ request.user.email }}</span></p>
</div>

<!-- Exibir mensagens de feedback -->
{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <p class="message {% if message.tags %}{{ message.tags }}{% endif %}">
                {{ message }}
            </p>
        {% endfor %}
    </div>
{% endif %}

<!-- Formulário para Atualizar Nome, E-mail e CNPJ -->
<form method="POST" id="profile-form">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Salvar Alterações</button>
</form>

<!-- Botão para excluir a conta -->
<form action="{% url 'deletar_conta' %}" method="POST" onsubmit="return confirm('Tem certeza que deseja excluir sua conta? Esta ação é irreversível!');">
    {% csrf_token %}
    <button type="submit" style="background-color: red; color: white;">Excluir Conta</button>
</form>

<!-- Script para Atualizar Nome e E-mail Dinamicamente -->
<script>
    document.getElementById("profile-form").addEventListener("submit", function() {
        let usernameInput = document.querySelector("input[name='username']").value;
        let emailInput = document.querySelector("input[name='email']").value;
        
        // Atualiza os valores no frontend
        document.getElementById("username-display").textContent = usernameInput;
        document.getElementById("email-display").textContent = emailInput;
    });
</script>

{% endblock %}

{%include 'usuarios/partials/footer.html'%}
<title> {% block title %}Perfil - QuickEAM{% endblock %}</title> 